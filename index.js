import{a as v,i as l,S as C,N as _,P as $,A as I,I as j}from"./assets/vendor-Cw2x0rFR.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const A="/categories",b="/furnitures",h=8,T="https://furniture-store.b.goit.study/api";async function y(e,t={}){try{const{page:r=1,limit:o=h,...s}=t;return(await v(`${T}${e}`,{params:{page:r,limit:o,...s}})).data}catch{l.error({title:"",message:"Помилка виконання запиту. Спробуйте ще раз.",position:"topRight",timeout:2e3,close:!1,maxWidth:300,messageColor:"#fff",color:"#e23232"})}}const a={orderModalBackdrop:document.querySelector(".order-modal-overlay"),orderModal:document.querySelector(".order-modal"),orderModalCloseBtn:document.querySelector(".modal-close"),orderFormEl:document.querySelector(".order-form"),orderModalLoader:document.querySelector(".loader"),categoriesGallery:document.querySelector(".furniture-categories-list"),furnitureGallery:document.querySelector(".furniture-gallery"),showMoreBtn:document.querySelector(".show-more-button"),loader:document.getElementById("loader")};function P(){a.orderModalBackdrop.classList.add("is-open"),document.body.style.overflow="hidden"}function g(){a.orderModalBackdrop.classList.remove("is-open"),document.body.style.overflow="",a.orderFormEl.reset()}const H={"66504a50a1b2c3d4e5f6a7b8":"Soft_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7b9":"Storage_systems_2x.jpg","66504a50a1b2c3d4e5f6a7ba":"Beds_2x.jpg","66504a50a1b2c3d4e5f6a7bb":"Tables_2x.jpg","66504a50a1b2c3d4e5f6a7bc":"Chairs_2x.jpg","66504a50a1b2c3d4e5f6a7bd":"Citchens_2x.jpg","66504a50a1b2c3d4e5f6a7be":"Children_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7bf":"Ofice_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7c0":"Corridor_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7c1":"Bathroom_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7c2":"Garden_furniture_2x.jpg","66504a50a1b2c3d4e5f6a7c3":"Accessuars_2x.jpg"};let n=1,c=1,f="",u=!1,p=[];function O(e){const t=`
        <li class="category-item">
            <div class="category-thumb all-categories-thumb" data-category-id="">
                <p class="category-title">Всі товари</p>
            </div>
        </li>
    `,r=e.map(({_id:o,name:s})=>{const i=`./img/${H[o]}`;return`<li class="category-item"><div class="category-thumb" data-category-id="${o}" style="background-image: url('${i}')" >
 <p class="category-title">${s}</p>
                </div>
            </li>`}).join("");a.categoriesGallery.insertAdjacentHTML("beforeend",t+r)}function L(e){return e.map(({name:t,color:r,price:o,images:s,_id:i})=>{const d=s[0]||"/img/All_products_2x.jpg",x=Array.isArray(r)?r.map(q=>`<span class="color-circle" style="background-color: ${q};"></span>`).join(""):`<span class="color-circle" style="background-color: ${r};"></span>`;return`
            <li class="gallery-item">
                <img class="gallery-img" src="${d}" alt="${t}" />
                <h3 class="furniture-title">${t}</h3>
                <div class="furniture-colors">${x}</div>
                <p class="furniture-price">${o} грн</p>
                <div class="wrapper">
                    <button class="details-btn" type="button" data-id="${i}">Детальніше</button>
                </div>
            </li>`}).join("")}async function F(){try{n=1,u=!0,a.showMoreBtn.classList.add("visually-hidden"),k();const e=await y(b,w(n));a.furnitureGallery.innerHTML=L(e.furnitures),p.length=0,p.push(...e.furnitures),c=Math.ceil((e.totalItems??0)/h),c>n&&a.showMoreBtn.classList.remove("visually-hidden")}catch(e){alert("Помилка завантаження меблів:",e.message)}finally{M(),u=!1}}async function G(){if(!u){if(n>=c){a.showMoreBtn.classList.add("visually-hidden");return}u=!0,a.showMoreBtn.disabled=!0,k();try{const e=n+1,t=await y(b,w(e));a.furnitureGallery.insertAdjacentHTML("beforeend",L(t.furnitures)),p.push(...t.furnitures),n=e,n>=c&&a.showMoreBtn.classList.add("visually-hidden")}catch(e){alert("Помилка при завантаженні наступної сторінки:",e.message)}finally{M(),a.showMoreBtn.disabled=!1,u=!1}}}function w(e){const t={page:e,limit:h};return f&&(t.category=f),t}async function N(e){const t=e.target.closest(".category-thumb");if(!t)return;const r=t.dataset.categoryId??"";r===f&&n===1||(document.querySelectorAll(".category-thumb.active").forEach(o=>o.classList.remove("active")),t.classList.add("active"),f=r,await R())}async function R(){try{n=1,a.showMoreBtn.classList.add("visually-hidden"),a.furnitureGallery.innerHTML="",k();const e=await y(b,w(n));a.furnitureGallery.innerHTML=L(e.furnitures),c=Math.ceil((e.totalItems??0)/h)||(e.totalPages??1),c>1&&a.showMoreBtn.classList.remove("visually-hidden")}catch(e){alert("Помилка перезавантаження першої сторінки:",e.message)}finally{M()}}function k(){var e,t;(e=a.loader)==null||e.classList.remove("hidden"),(t=a.loader)==null||t.setAttribute("aria-hidden","false")}function M(){var e,t;(e=a.loader)==null||e.classList.add("hidden"),(t=a.loader)==null||t.setAttribute("aria-hidden","true")}y(A,{page:1,limit:100}).then(e=>{O(e),a.categoriesGallery.addEventListener("click",N)}).catch(e=>{alert(e.message)});F().catch(e=>{alert(e.message)});a.showMoreBtn.addEventListener("click",G);class D{constructor(){this.swiper=null,this.feedbacks=[],this.init()}init(){this.loadFeedbacks()}async loadFeedbacks(){try{this.showLoading();const t=await v.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{limit:10,page:1}});this.feedbacks=t.data.feedbacks,this.renderFeedbacks(),this.initSwiper()}catch(t){console.error("Помилка завантаження відгуків:",t),this.showError()}}showLoading(){const t=document.querySelector(".swiper-wrapper");t.innerHTML='<div class="loading">Завантаження відгуків...</div>'}showError(){const t=document.querySelector(".swiper-wrapper");t.innerHTML='<div class="error">Помилка завантаження відгуків. Спробуйте пізніше.</div>'}roundRating(t){return t>=3.3&&t<=3.7?3.5:t>=3.8&&t<=4.2?4:Math.round(t*2)/2}generateStars(t){const r=this.roundRating(t);let o="";for(let s=1;s<=5;s++)s<=r?o+='<svg class="star" width="23" height="23"><use href="/img/svg/icon.svg#star-full"></use></svg>':s-.5===r?o+='<svg class="star" width="24" height="24"><use href="/img/svg/icon.svg#half-star"></use></svg>':o+='<svg class="star" width="23" height="23"><use href="/img/svg/icon.svg#star-empty"></use></svg>';return o}renderFeedbacks(){const t=document.querySelector(".swiper-wrapper"),r=this.feedbacks.map(o=>`
            <div class="swiper-slide">
                <div class="feedback-card">
                    <div class="star-rating">
                        ${this.generateStars(o.rate)}
                    </div>
                    <div class="feedback-text">"${o.descr}"</div>
                    <div class="feedback-author">${o.name}</div>
                </div>
            </div>
        `).join("");t.innerHTML=r}initSwiper(){const t=document.getElementById("prevBtn"),r=document.getElementById("nextBtn");this.swiper=new C(".feedback-swiper",{modules:[_,$],slidesPerView:1,slidesPerGroup:1,spaceBetween:0,loop:!1,grabCursor:!0,pagination:{el:".feedback-pagination",clickable:!0,bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active"},navigation:{nextEl:r,prevEl:t},breakpoints:{768:{slidesPerView:2,slidesPerGroup:2,spaceBetween:24},1024:{slidesPerView:3,slidesPerGroup:3,spaceBetween:24}},on:{slideChange:()=>{this.updateNavigationButtons()},reachBeginning:()=>{this.updateNavigationButtons()},reachEnd:()=>{this.updateNavigationButtons()}}}),this.updateNavigationButtons()}updateNavigationButtons(){const t=document.getElementById("prevBtn"),r=document.getElementById("nextBtn");this.swiper.isBeginning?(t.classList.add("disabled"),t.setAttribute("disabled","true")):(t.classList.remove("disabled"),t.removeAttribute("disabled")),this.swiper.isEnd?(r.classList.add("disabled"),r.setAttribute("disabled","true")):(r.classList.remove("disabled"),r.removeAttribute("disabled"))}}document.addEventListener("DOMContentLoaded",()=>{new D});new I(".accordion-container",{duration:250,showMultiple:!1});const U="https://furniture-store.b.goit.study/api";async function V(e){console.log(e);try{return(await v.post(`${U}/orders`,e,{headers:{"Content-Type":"application/json"}})).data}catch{l.error({message:"Сталася помилка, спробуйте ще раз",position:"topRight"})}}function W(e){return e>=3.3&&e<=3.7?3.5:e>=3.8&&e<=4.2?4:Math.round(e*2)/2}function z(e){const t=W(e);let r="";for(let o=1;o<=5;o++)o<=t?r+='<svg class="star"><use href="./img/svg/icon.svg#star-full"></use></svg>':o-.5===t?r+='<svg class="star"><use href="./img/svg/icon.svg#half-star"></use></svg>':r+='<svg class="star"><use href="./img/svg/icon.svg#star-empty"></use></svg>';return r}document.addEventListener("click",e=>{const t=e.target.closest(".details-btn");if(!t)return;const r=t.dataset.id,o=p.find(s=>s._id===r);o&&K(o)});let E={id:"",color:""};function K(e){E.id=e._id;const t=document.querySelector("[data-modal]"),r=e.images.map((s,i)=>`
    <li class="${i===0?"large":"small"}">
      <img class="gallery-images" src="${s}" alt="${e.name}-${i+1}">
    </li>
  `).join("");t.querySelector(".gallery-details").innerHTML=r,t.querySelector(".details-title").textContent=e.name,t.querySelector(".details-category").textContent=e.category.name,t.querySelector(".details-price").innerHTML=`${e.price} <span class="price-currency">грн</span>`,document.querySelector("#rating").innerHTML=z(e.rate);const o=e.color.map((s,i)=>`
    <li>
      <input class="color-checkbox visually-hidden" type="checkbox" id="color${i+1}" value="${s}">
      <label class="color-label" for="color${i+1}">
        <span class="modal-checkbox" style="background-color:${s}"></span>
      </label>
    </li>
  `).join("");t.querySelector(".color-options").innerHTML=o,t.querySelector(".details-description").textContent=e.description,t.querySelector(".details-size").textContent=e.sizes,t.classList.add("is-open"),document.body.style.overflow="hidden",Q(),document.addEventListener("keydown",S),t.addEventListener("click",B),t.querySelector("[data-modal-close]").addEventListener("click",m)}function Q(){const e=document.querySelectorAll(".color-checkbox");e.forEach(t=>{t.addEventListener("change",()=>{t.checked&&e.forEach(r=>{r!==t&&(r.checked=!1)})})})}document.querySelector(".modal-order-btn").addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".color-checkbox:checked");if(!t){l.warning({title:"Увага",message:"Оберіть, будь ласка, колір",position:"center",timeout:2e3});return}E.color=t.value,m(),P()});function m(){const e=document.querySelector("[data-modal]");e.classList.remove("is-open"),document.body.style.overflow="",document.removeEventListener("keydown",S),e.removeEventListener("click",B),e.querySelector("[data-modal-close]").removeEventListener("click",m)}function B(e){e.target.hasAttribute("data-modal")&&m()}function S(e){e.key==="Escape"&&m()}const J=document.getElementById("phone-input"),X={mask:"+{38} (000) 000 00 00"};j(J,X);a.orderModalCloseBtn.addEventListener("click",g);a.orderModalBackdrop.addEventListener("click",e=>{e.target===a.orderModalBackdrop&&g()});document.addEventListener("keydown",e=>{e.key==="Escape"&&!a.orderModalBackdrop.classList.contains("hidden")&&g()});a.orderFormEl.addEventListener("submit",e=>Y(e));async function Y(e,t){if(e.preventDefault(),!a.orderFormEl.checkValidity()){l.error({message:"Будь ласка, заповніть всі обов’язкові поля.",position:"topRight"});return}const{id:r,color:o}=E,s={email:a.orderFormEl.email.value.trim(),phone:a.orderFormEl.phone.value.trim().replace(/\D/g,""),modelId:r,color:o,comment:a.orderFormEl.comment.value.trim()};try{a.orderModalLoader.classList.remove("hidden");const i=await V(s);i&&(l.success({message:"Заявку успішно надіслано!",position:"topRight"}),g(),console.log("Order created:",i))}catch{l.error({message:"Сталася помилка, спробуйте ще раз",position:"topRight"});return}finally{a.orderModalLoader.classList.add("hidden"),g()}}
//# sourceMappingURL=index.js.map
